data$okbørn               <- okbørn
okcykel                   <- cykel_okalkohol
levels(okcykel)           <- c("1-2", "3-8", "3-8", "9-12", "EMPTY", "Ingen genstande", "Mere end 12 genstande")
data$okcykel              <- okcykel
okarbejde                 <- arbejd_okalkohol
levels(okarbejde)         <- c("+1", "+1", "EMPTY", "Ingen genstande")
data$okarbejde            <- okarbejde
okjulefrokost             <- julefrokost_okalkohol
levels(okjulefrokost)[levels(okjulefrokost) != "Mere end 12 genstande"]     <- "Under 12 genstande"
data$okjulefrokost        <- okjulefrokost
okfestbørn                <- festbørn_okalkohol
levels(okfestbørn)        <- c("1-5", "1-5", "6-8", "+9", "EMPTY", "Ingen genstande", "+9")
data$okfestbørn           <- okfestbørn
okfest                    <- fest_okalkohol
levels(okfest)            <- c("1-2", "3-12", "3-12", "3-12", "3-12", "EMPTY", "0", "+12")
data$okfest               <- okfest
okhverdag                 <- hverdag_okalkohol
levels(okhverdag)         <- c("1-5", "1-5", "6-8", "EMPTY", "0", "+12")
data$okhverdag            <- okhverdag
a                          <- data.frame(børn_okalkohol, bil_okalkohol, cykel_okalkohol, arbejd_okalkohol, hverdag_okalkohol,
søndag_okalkohol, fest_okalkohol, julefrokost_okalkohol, festbørn_okalkohol)
o                          <- rowSums(a=="Ingen genstande")
okdeterikkeok              <- vector(length=length(o))
okdeterikkeok[o < 4]       <- "Permissive"
okdeterikkeok[o >= 4]      <- "Restrictive"
data$okdeterikkeok         <- okdeterikkeok
####### Omkodning andre
omgangskreds             <- omgangskreds_drukvurdering
levels(omgangskreds)     <- c("Det samme eller lidt mindre", "EMPTY", "Lidt mere", "Det samme eller lidt mindre" ,"Meget mere", "Meget mindre")
data$omgangskreds        <- omgangskreds
danskere                 <- danskere_drukvurdering
levels(danskere)         <- c("Ikke lidt mere", "EMPTY", "Lidt mere", "Ikke lidt mere", "Ikke lidt mere", "Ikke lidt mere")
data$danskere            <- danskere
danskerehykler           <- (danskere_drukvurdering == "Det samme" | danskere_drukvurdering == "Lidt mindre" | danskere_drukvurdering == "Meget mindre") & druk=="Højt alkoholforbrug"
data$danskerehykler      <- danskerehykler
####### Omkodning positive konsekvenser af alkohol
selvbehandling           <- fysisksmerte_poskons_mca == "Lidt" | fysisksmerte_poskons_mca == "Noget" | psykiskenede_poskons_mca == "Lidt" | psykiskenede_poskons_mca == "Noget"
data$selvbehandling      <- selvbehandling
festligpositivkons       <- (sjoveoplevelser_poskons == "Meget" | sjoveoplevelser_poskons == "Noget") + (selvtillid_poskons == "Meget" | selvtillid_poskons == "Noget") + (venskab_poskons_mca == "Noget eller meget")
data$festligpositivkons  <- festligpositivkons
madposkons               <- madoplevelse_poskons
levels(madposkons)       <- c("EMPTY", "Lidt eller noget", "Meget", "Lidt eller noget", "Slet ikke")
data$madposkons          <- madposkons
####### Omkodning begræns
levels(reduce)           <- c("EMPTY", "Reduce: No", "Reduce: No or partial success", "Reduce: No or partial success", "Reduce: Successfully")
data$reduce              <- reduce
skærenedbørn             <- gravid_skærenedhvorfor == "Ja" | fikbørn_skærenedhvorfor == "Ja"
data$skærenedbørn        <- skærenedbørn
skærenedsundhedogvægt      <- sundhed_skærenedhvorfor == "Ja" | vægttab_skærenedhvorfor == "Ja"
data$skærenedsundhedogvægt <- skærenedsundhedogvægt
######## Omkodning Audit
auditstoppe                <- auditduhavdesvrtvedatstoppedaduf
levels(auditstoppe)        <- c("Aldrig", "Ugentligt og oftere", "EMPTY","Månedligt" , "Sjældent", "Ugentligt og oftere")
data$auditstoppe           <- auditstoppe
auditmorgendram            <- auditdumttehaveenlillenommorgene
levels(auditmorgendram)    <- c("Aldrig", "EMPTY", "Sjældent eller mere", "Sjældent eller mere", "Sjældent eller mere" )
data$auditmorgendram       <- auditmorgendram
audithuske                 <- auditdukunneikkehuskehvaddersket
levels(audithuske)         <- c("Aldrig", "Månedligt eller oftere", "EMPTY", "Månedligt eller oftere", "Sjældent", "Månedligt eller oftere")
data$audithuske            <- audithuske
auditsamvittighed          <- auditdufikdrligsamvittighedeller
levels(auditsamvittighed)  <- c("Aldrig", "Månedligt eller oftere", "EMPTY", "Månedligt eller oftere", "Sjældent", "Månedligt eller oftere")
data$auditsamvittighed     <- auditsamvittighed
auditskala                 <- (auditstoppe == "Ugentligt og oftere" | auditstoppe == "Månedligt") + (audithuske == "Månedligt eller oftere") +  (auditsamvittighed == "Månedligt eller oftere")
data$auditskala            <- auditskala
####### Omkod rygning
ryg <- as.numeric(as.character(ryger_antal))
ryger_antalsmøger <- as.character(ryger_antal)
ryger_antalsmøger[ryg < 5] <- "1-4"
ryger_antalsmøger[ryg >= 5 & ryg < 10] <- "5-9"
ryger_antalsmøger[ryg >= 10 & ryg < 20] <- "10-19"
ryger_antalsmøger[ryg >= 20] <- "+20"
ryger_antalsmøger[is.na(ryger_antalsmøger)] <- "EMPTY"
data$ryger_antalsmøger <- ryger_antalsmøger
###### Omkod binge
## Kønsspecifikt #
## Variable:
# Maxdruk
# Gåkold
# Es
pass_out <- as.character(gåkold)
#table(pass_out)
p <- as.numeric(pass_out)
pass_out[p  > 29]                     <- "Passes out at more than 30 units"
pass_out[p  > 20 & p < 30]            <- "Passes out at between 21-29 units"
pass_out[p  > 15 & p < 21]            <- "Passes out at between 16-20 units"
pass_out[p  > 10 & p < 16]            <- "Passes out at between 11-15 units"
pass_out[p  > 7 & p < 11]             <- "Passes out at between 8-10 units"
pass_out[p  > 4 & p < 8]              <- "Passes out at between 5-7 units"
pass_out[p  > 0 & p < 5]              <- "Passes out at between 1-4 units"
pass_out[p  == 0]                     <- "Passes out at 0 units(!?)"
data$pass_out                         <- pass_out
data$passout                          <- p
max_drinking <- as.character(maxdruk)
max_drinking[max_drinking =="1-2 genstande"]      <-"Has at the most been drinking more than 2 units last year"
max_drinking[max_drinking =="3-5 genstande"]      <-"Has at the most been drinking more than 3-4 units last year"
max_drinking[max_drinking =="5-7 genstande"]      <-"Has at the most been drinking more than 5-7 units last year"
max_drinking[max_drinking =="8-10 genstande"]     <-"Has at the most been drinking more than 8-10 units last year"
max_drinking[max_drinking =="11-14 genstande"]    <-"Has at the most been drinking more than 11-14 units last year"
max_drinking[max_drinking =="15-20 genstande"]    <-"Has at the most been drinking more than 15-20 units last year"
max_drinking[max_drinking =="21-29 genstande"]    <-"Has at the most been drinking more than 21-29 units last year"
max_drinking[max_drinking =="Over 30 genstande"]  <-"Has been drinking more than 30 units last year"
data$max_drinking                                 <- max_drinking
#table(max_drinking)
table(genstande_es)
on_top_off_the_world <- as.character(genstande_es)
o <- as.numeric(on_top_off_the_world)
on_top_off_the_world[o  > 8 ]                     <- "Needs more than 8 units to feel 'On top of the world'"
on_top_off_the_world[o  > 5 & o < 9]              <- "Needs between 6-8 units to feel 'On top of the world'"
on_top_off_the_world[o  > 3 & o < 6]              <- "Needs between 4-5 units to feel 'On top of the world'"
on_top_off_the_world[o  > 1 & o < 4]              <- "Needs between 2-3 units to feel 'On top of the world'"
on_top_off_the_world[o  == 1]                     <- "Needs 1 unit to feel 'On top of the world'"
on_top_off_the_world[o  == 0]                     <- "Does not need any units to feel 'On top of the world'"
data$on_top_off_the_world                         <- on_top_off_the_world
data$ontop                                        <- o
# + 10
drinking_10plus_units_last_month <- as.character(måneddruk_10genstande)
d <- as.numeric(drinking_10plus_units_last_month)
drinking_10plus_units_last_month[d  > 4]             <- "Has been drinking more than 10 units at least 5 times the past month"
drinking_10plus_units_last_month[d  > 2 & d < 5]     <- "Has been drinking more than 10 units from 3-4 times the past month"
drinking_10plus_units_last_month[d  == 2]            <- "Has been drinking more than 10 units 2 times the past month"
drinking_10plus_units_last_month[d  == 1]            <- "Has been drinking more than 10 units 1 time the past month"
drinking_10plus_units_last_month[d  == 0]            <- "Has not been drinking more than 10 units the past month"
data$drinking_10plus_units_last_month                <- drinking_10plus_units_last_month
#6-9
drinking_6_9_units_last_month <- as.character(måneddruk_6_9_genstande)
d <- as.numeric(drinking_6_9_units_last_month)
drinking_6_9_units_last_month[d  > 5]                <- "Has been drinking between 6 to 9 units at least 6 times the past month"
drinking_6_9_units_last_month[d  > 2 & d < 6]        <- "Has been drinking between 6 to 9 units from 3-5 times the past month"
drinking_6_9_units_last_month[d  == 2]               <- "Has been drinking between 6 to 9 units 2 times the past month"
drinking_6_9_units_last_month[d  == 1]               <- "Has been drinking between 6 to 9 units 1 time the past month"
drinking_6_9_units_last_month[d  == 0]               <- "Has not been drinking between 6 to 9 units the past month"
data$drinking_6_9_units_last_month                   <-  drinking_6_9_units_last_month
#3-5
drinking_3_5_units_last_month <- as.character(måneddruk_3_5genstande)
d <- as.numeric(drinking_3_5_units_last_month)
drinking_3_5_units_last_month[d  > 14]              <- "Has been drinking between 3 to 5 units at least 15 times the past month"
drinking_3_5_units_last_month[d  > 8 & d < 15]      <- "Has been drinking between 3 to 5 units from 9-14 times the past month"
drinking_3_5_units_last_month[d  > 4 & d < 9]       <- "Has been drinking between 3 to 5 units from 5-8 times the past month"
drinking_3_5_units_last_month[d  > 2 & d < 5]       <- "Has been drinking between 3 to 5 units from 3-4 times the past month"
drinking_3_5_units_last_month[d  == 2]              <- "Has been drinking between 3 to 5 units 2 times the past month"
drinking_3_5_units_last_month[d  == 1]              <- "Has been drinking between 3 to 5 units 1 time the past month"
drinking_3_5_units_last_month[d  == 0]              <- "Has not been drinking between 3 to 5 units the past month"
data$drinking_3_5_units_last_month                  <- drinking_3_5_units_last_month
table(drinking_3_5_units_last_month)
# +6
drinking_6plus_units_last_month <- as.numeric(as.character(måneddruk_6_9_genstande)) + as.numeric(as.character(måneddruk_10genstande))
d <- as.numeric(drinking_6plus_units_last_month)
drinking_6plus_units_last_month[d  > 9]                <- "Has been drinking more than 6 units at least 10 times the past month"
drinking_6plus_units_last_month[d  > 4 & d < 10]       <- "Has been drinking more than 6 units from 5-9 times the past month"
drinking_6plus_units_last_month[d  > 2 & d < 5]        <- "Has been drinking more than 6 units from 3-4 times the past month"
drinking_6plus_units_last_month[d  == 2]               <- "Has been drinking more than 6 units 2 times the past month"
drinking_6plus_units_last_month[d  == 1]               <- "Has been drinking more than 6 units 1 time the past month"
drinking_6plus_units_last_month[d  == 0]               <- "Has not been drinking more than 6 units the past month"
data$drinking_6plus_units_last_month                   <- drinking_6plus_units_last_month
table(drinking_6plus_units_last_month)
#+3
drinking_3plus_units_last_month <- as.numeric(as.character(måneddruk_3_5genstande)) + as.numeric(as.character(måneddruk_6_9_genstande)) + as.numeric(as.character(måneddruk_10genstande))
d <- as.numeric(drinking_3plus_units_last_month)
drinking_3plus_units_last_month[d  > 19]                <- "Has been drinking more than 3 units at least 20 times the past month"
drinking_3plus_units_last_month[d  > 10 & d < 20]       <- "Has been drinking more than 3 units from 11-19 times the past month"
drinking_3plus_units_last_month[d  > 7  & d < 11]       <- "Has been drinking more than 3 units from 8-10 times the past month"
drinking_3plus_units_last_month[d  > 4  & d < 8]        <- "Has been drinking more than 3 units from 5-7 times the past month"
drinking_3plus_units_last_month[d  > 2 & d < 5]         <- "Has been drinking more than 3 units from 3-4 times the past month"
drinking_3plus_units_last_month[d  == 2]                <- "Has been drinking more than 3 units 2 times the past month"
drinking_3plus_units_last_month[d  == 1]                <- "Has been drinking more than 3 units 1 time the past month"
drinking_3plus_units_last_month[d  == 0]                <- "Has not been drinking more than 3 units the past month"
data$drinking_3plus_units_last_month                    <- drinking_3plus_units_last_month
table(drinking_3plus_units_last_month)
# lidt hverdagsdruk
drinking_last_month <- as.numeric(as.character(måneddruk_1_2genstande)) + as.numeric(as.character(måneddruk_3_5genstande)) + as.numeric(as.character(måneddruk_6_9_genstande)) + as.numeric(as.character(måneddruk_10genstande))
d <- as.numeric(drinking_last_month)
drinking_last_month[d  > 29]                <- "Has been drinking at least 30 times the past month"
drinking_last_month[d  > 7  & d < 30]       <- "Has been drinking from 8-29 times the past month"
drinking_last_month[d  > 4  & d < 8]        <- "Has been drinking from 5-7 times the past month"
drinking_last_month[d  > 2 & d < 5]         <- "Has been drinking from 3-4 times the past month"
drinking_last_month[d  == 2]                <- "Has been drinking 2 times the past month"
drinking_last_month[d  == 1]                <- "Has been drinking 1 time the past month"
drinking_last_month[d  == 0]                <- "Has not been drinking the past month"
data$drinking_last_month                    <- drinking_last_month
## nye, nye omkodninger
drinking_3plus_units_last_month <- as.numeric(as.character(måneddruk_3_5genstande)) + as.numeric(as.character(måneddruk_6_9_genstande)) + as.numeric(as.character(måneddruk_10genstande))
d <- as.numeric(drinking_3plus_units_last_month)
drinking_3plus_units_last_month[d  > 19]                <- "Has been drinking more than 3 units at least 20 times the past month"
drinking_3plus_units_last_month[d  > 4 & d < 20]       <- "Has been drinking more than 3 units from 5-19 times the past month"
drinking_3plus_units_last_month[d  > 1 & d < 5]        <- "Has been drinking more than 3 units from 2-4 times the past month"
drinking_3plus_units_last_month[d  == 1]               <- "Has been drinking more than 3 units 1 time the past month"
drinking_3plus_units_last_month[d  == 0]               <- "Has not been drinking more than 3 units the past month"
data$drinking_3plus_units_last_month                   <-  drinking_3plus_units_last_month
data$drink3plus                                        <- d
drinking_6plus_units_last_month <- as.numeric(as.character(måneddruk_6_9_genstande)) + as.numeric(as.character(måneddruk_10genstande))
d <- as.numeric(drinking_6plus_units_last_month)
drinking_6plus_units_last_month[d  > 9]                <- "Has been drinking more than 6 units at least 10 times the past month"
drinking_6plus_units_last_month[d  > 2 & d < 10]       <- "Has been drinking more than 6 units from 3-9 times the past month"
drinking_6plus_units_last_month[d  > 0 & d < 3]        <- "Has been drinking more than 6 units from 1-2 times the past month"
drinking_6plus_units_last_month[d  == 0]               <- "Has not been drinking more than 6 units the past month"
data$drinking_6plus_units_last_month                   <- drinking_6plus_units_last_month
data$drink6plus                                        <- d
table(drinking_6plus_units_last_month)
drinking_10plus_units_last_month <- as.character(måneddruk_10genstande)
d <- as.numeric(drinking_10plus_units_last_month)
drinking_10plus_units_last_month[d  > 4]                <- "Has been drinking more than 10 units at least 5 times the past month"
drinking_10plus_units_last_month[d  > 1 & d < 5]        <- "Has been drinking more than 10 units from 2-4 times the past month"
drinking_10plus_units_last_month[d  == 1]               <- "Has been drinking more than 10 units 1 time the past month"
drinking_10plus_units_last_month[d  == 0]               <- "Has not been drinking more than 10 units the past month"
data$drinking_10plus_units_last_month                   <- drinking_10plus_units_last_month
drinking_last_month <- as.numeric(as.character(måneddruk_1_2genstande)) + as.numeric(as.character(måneddruk_3_5genstande)) + as.numeric(as.character(måneddruk_6_9_genstande)) + as.numeric(as.character(måneddruk_10genstande))
d <- as.numeric(drinking_last_month)
# drinking_last_month[d  > 29]               <- "Has been drinking at least 30 times the past month"
# drinking_last_month[d  > 7 & d < 30]       <- "Has been drinking from 8-29 times the past month"
# drinking_last_month[d  > 2  & d < 8]       <- "Has been drinking from 3-7 times the past month"
# drinking_last_month[d  > 0  & d < 3]       <- "Has been drinking from 1-2 times the past month"
# drinking_last_month[d  == 0]               <- "Has not been drinking the past month"
drinking_last_month[d  > 29]               <- "Has been drinking every day the last month"
drinking_last_month[d  >= 13 & d < 30]     <- "Has been drinking from 13-29 times the past month"
drinking_last_month[d  > 7  & d < 13]      <- "Has been drinking from 8-12 times the past month"
drinking_last_month[d  > 4  & d < 8]       <- "Has been drinking from 5-7 times the past month"
drinking_last_month[d  > 2 & d < 5]        <- "Has been drinking from 3-4 times the past month"
drinking_last_month[d  == 2]               <- "Has been drinking 2 times the past month"
drinking_last_month[d  == 1]               <- "Has been drinking 1 time the past month"
drinking_last_month[d  == 0]               <- "Has not been drinking the past month"
data$drinking_last_month                   <- drinking_last_month
data$drinkmonth                            <- d
every_binge_1_2  <- (as.numeric(as.character(måneddruk_3_5genstande)) + as.numeric(as.character(måneddruk_6_9_genstande)) + as.numeric(as.character(måneddruk_10genstande)))/ (as.numeric(as.character(måneddruk_1_2genstande)) + as.numeric(as.character(måneddruk_3_5genstande)) + as.numeric(as.character(måneddruk_6_9_genstande)) + as.numeric(as.character(måneddruk_10genstande)))
eb <- as.numeric(every_binge_1_2)
every_binge_1_2[eb>0.75]                   <- "Binging (more than 2 units) on more than 75 % of drinking occations"
every_binge_1_2[eb>0.49 & eb<0.76]         <- "Binging (more than 2 units) on more between 50-75 % of drinking occations"
every_binge_1_2[eb>0.24 & eb<0.50]         <- "Binging (more than 2 units) on more between 25-49 % of drinking occations"
every_binge_1_2[eb<0.25]                   <- "Binging (more than 2 units) on less than 25 % of drinking occations"
data$every_binge_1_2                       <- every_binge_1_2
every_binge_1_5  <-  (as.numeric(as.character(måneddruk_6_9_genstande)) + as.numeric(as.character(måneddruk_10genstande)))/ (as.numeric(as.character(måneddruk_1_2genstande)) + as.numeric(as.character(måneddruk_3_5genstande)) + as.numeric(as.character(måneddruk_6_9_genstande)) + as.numeric(as.character(måneddruk_10genstande)))
eb <- as.numeric(every_binge_1_5)
every_binge_1_5[eb>0.75]                   <- "Heavy binging (more than 5 units) on more than 75 % of drinking occations"
every_binge_1_5[eb>0.49 & eb<0.76]         <- "Heavy binging (more than 5 units) on more between 50-75 % of drinking occations"
every_binge_1_5[eb>0.24 & eb<0.50]         <- "Heavy binging (more than 5 units) on more between 25-49 % of drinking occations"
every_binge_1_5[eb<0.25]                   <- "Heavy binging (more than 5 units) on less than 25 % of drinking occations"
data$every_binge_1_5                       <- every_binge_1_5
data$bingeandel                            <- eb
everyday <- every_binge_1_5
everyday [every_binge_1_5 == "Heavy binging (more than 5 units) on less than 25 % of drinking occations" & drinking_last_month == "Has been drinking at least 30 times the past month" ]                   <-"Heavy binging (more than 5 units) on less than 25 % of drinking occations AND drinking at least 8 times the last month"
everyday [every_binge_1_5 == "Heavy binging (more than 5 units) on less than 25 % of drinking occations" & drinking_last_month == "Has been drinking from 8-29 times the past month" ]                   <-"Heavy binging (more than 5 units) on less than 25 % of drinking occations AND drinking at least 8 times the last month"
data$everyday                              <-everyday
hverdagsdruk_gnm                                                            <- as.numeric(as.character(hverdagsdruk))/5
data$hverdagsdruk_gnm                                                       <-  hverdagsdruk_gnm
hverdagsdruk_gnm_kat                                                        <- hverdagsdruk_gnm
hverdagsdruk_gnm_kat[hverdagsdruk_gnm > 2.5]                                <- "Driks more than 2.5 units on average on working days"
hverdagsdruk_gnm_kat[hverdagsdruk_gnm < 2.6 & hverdagsdruk_gnm > 1.9]       <- "Driks between 2-2.5 units on average on working days"
hverdagsdruk_gnm_kat[hverdagsdruk_gnm < 2.0 & hverdagsdruk_gnm > 1.4]       <- "Driks between 1.5-1.9 units on average on working days"
hverdagsdruk_gnm_kat[hverdagsdruk_gnm < 1.5 & hverdagsdruk_gnm > 0.9]       <- "Driks between 1-1.4 units on average on working days"
hverdagsdruk_gnm_kat[hverdagsdruk_gnm < 1.0 & hverdagsdruk_gnm > 0.4]       <- "Driks between 0.5-0.9 units on average on working days"
hverdagsdruk_gnm_kat[hverdagsdruk_gnm < 0.5 & hverdagsdruk_gnm > 0]         <- "Driks between 0.1-0.4 units on average on working days"
hverdagsdruk_gnm_kat[hverdagsdruk_gnm == 0]                                 <- "Does not drik on working days"
data$hverdagsdruk_gnm_kat                                                   <-  hverdagsdruk_gnm_kat
data$hverdagsdruk_gnm
weekenddruk                                                                 <- as.numeric(as.character(weekenddruk))
weekenddruk_kat                                                             <- weekenddruk
weekenddruk_kat[weekenddruk > 20]                                           <- "Drank more than 20 units last weekend"
weekenddruk_kat[weekenddruk < 21 & weekenddruk > 15]                        <- "Drak between 16-20 units last weekend"
weekenddruk_kat[weekenddruk < 16 & weekenddruk > 10]                        <- "Drak between 11-15 units last weekend"
weekenddruk_kat[weekenddruk < 11 & weekenddruk > 6]                         <- "Drak between 7-10 units last weekend"
weekenddruk_kat[weekenddruk < 7 & weekenddruk > 3]                          <- "Drak between 4-6 units last weekend"
weekenddruk_kat[weekenddruk < 4 & weekenddruk > 0]                          <- "Drak between 1-3 units last weekend"
weekenddruk_kat[weekenddruk == 0]                                           <- "Dids not drik last weekend"
data$weekenddruk_kat                                                        <-  weekenddruk_kat
data$weekenddruk                                                            <-  weekenddruk
hverdage         <- data.frame(mandag, tirsdag, onsdag, torsdag)
hverdage         <- apply(hverdage, 2, as.character)
hverdage         <- apply(hverdage, 2, as.numeric)
maxhverdag      <- apply(hverdage, 1 , max)
maxhverdag_kat                                                              <- maxhverdag
maxhverdag_kat[maxhverdag > 8]                                              <- "Has been drinking more than 8 units on a weekday"
maxhverdag_kat[maxhverdag < 9 & maxhverdag > 5]                             <- "Has been drinking between 6-8 units on a weekday"
maxhverdag_kat[maxhverdag < 6 & maxhverdag > 2]                             <- "Has been drinking between 3-5 units on a weekday"
maxhverdag_kat[maxhverdag < 3 & maxhverdag > 0]                             <- "Has been drinking between 1-2 units on a weekday"
maxhverdag_kat[maxhverdag == 0]                                             <- "Has not been drinking on a weekday"
data$maxhverdag_kat                                                         <-  maxhverdag_kat
data$maxhverdag                                                             <- maxhverdag
ugedruk_mand      <- as.numeric(as.character(ugedruk_mand))
ugedruk_kvinde    <- as.numeric(as.character(ugedruk_kvinde))
table(ugedruk_kvinde)
ugedruk_mand_kat                                                <- ugedruk_mand
ugedruk_mand_kat[ugedruk_mand == 8888]                          <- "Woman"
ugedruk_mand_kat[ugedruk_mand < 8888 & ugedruk_mand > 21]       <- "Man: Drank more than 21 units last week"
ugedruk_mand_kat[ugedruk_mand < 22 & ugedruk_mand > 18]         <- "Man: Drank between 19-21 units last week"
ugedruk_mand_kat[ugedruk_mand < 19 & ugedruk_mand > 14]         <- "Man: Drank between 15-18 units last week"
ugedruk_mand_kat[ugedruk_mand < 15 & ugedruk_mand > 7]          <- "Man: Drank between 8-14 units last week"
ugedruk_mand_kat[ugedruk_mand < 8 & ugedruk_mand > 2]           <- "Man: Drank between 3-7 units last week"
ugedruk_mand_kat[ugedruk_mand < 3 & ugedruk_mand > 0]           <- "Man: Drank between 1-2 units last week"
ugedruk_mand_kat[ugedruk_mand == 0]                             <- "Man: Did not drink last week"
data$ugedruk_mand_kat                                           <- ugedruk_mand_kat
ugedruk_kvinde_kat                                                    <- ugedruk_kvinde
ugedruk_kvinde_kat[ugedruk_kvinde == 8888]                            <- "Man"
ugedruk_kvinde_kat[ugedruk_kvinde < 8888 & ugedruk_kvinde > 20]       <- "Woman: Drank more than 20 units last week"
ugedruk_kvinde_kat[ugedruk_kvinde < 21 & ugedruk_kvinde > 14]         <- "Woman: Drank between 15-20 units last week"
ugedruk_kvinde_kat[ugedruk_kvinde < 15 & ugedruk_kvinde > 10]         <- "Woman: Drank between 11-14 units last week"
ugedruk_kvinde_kat[ugedruk_kvinde < 11 & ugedruk_kvinde > 7]          <- "Woman: Drank between 8-10 units last week"
ugedruk_kvinde_kat[ugedruk_kvinde < 8 & ugedruk_kvinde > 2]           <- "Woman: Drank between 3-7 units last week"
ugedruk_kvinde_kat[ugedruk_kvinde < 3 & ugedruk_kvinde > 0]           <- "Woman: Drank between 1-2 units last week"
ugedruk_kvinde_kat[ugedruk_kvinde == 0]                               <- "Woman: Did not drink last week"
data$ugedruk_kvinde_kat                                               <- ugedruk_kvinde_kat
drink_recomendation_man                                                     <- ugedruk_mand
drink_recomendation_man[ugedruk_mand == 8888]                               <- "Woman"
drink_recomendation_man[ugedruk_mand < 8888 & ugedruk_mand > 21]            <- "Man: Drank more than recomened (21 units) last week"
drink_recomendation_man[ugedruk_mand <= 21  & ugedruk_mand > 18]            <- "Man: Drank close to max recomened (19-21 units) last week"
drink_recomendation_man[ugedruk_mand < 19  & ugedruk_mand > 14]             <- "Man: Drank over new recomendations (15-18 units) last week"
drink_recomendation_man[ugedruk_mand < 15  & ugedruk_mand > 0]              <- "Man: Drank less than recomended (1-14 units) last week"
drink_recomendation_man[ugedruk_mand == 0]                                  <- "Man: Did not drink last week"
data$drink_recomendation_man                                                <- drink_recomendation_man
drink_recomendation_woman                                                     <- ugedruk_kvinde
drink_recomendation_woman[ugedruk_kvinde == 8888]                             <- "Woman"
drink_recomendation_woman[ugedruk_kvinde < 8888 & ugedruk_kvinde > 14]        <- "Woman: Drank more than recomened (14 units) last week"
drink_recomendation_woman[ugedruk_kvinde < 15  & ugedruk_kvinde > 11]         <- "Woman: Drank close to max recomened (12-14 units) last week"
drink_recomendation_woman[ugedruk_kvinde > 7  & ugedruk_kvinde < 12]          <- "Woman: Drank over new recomendations (8-11 units) last week"
drink_recomendation_woman[ugedruk_kvinde <= 7  & ugedruk_kvinde > 0]          <- "Woman: Drank less than recomended (1-7 units) last week"
drink_recomendation_woman[ugedruk_kvinde == 0]                                <- "Woman: Did not drink last week"
data$drink_recomendation_woman                                                <- drink_recomendation_woman
drink_recomendation                                                                                                   <- drink_recomendation_man
drink_recomendation[ugedruk_mand < 8888 & ugedruk_mand > 21 | ugedruk_kvinde < 8888 & ugedruk_kvinde > 14]            <- "Drank more than recomened last week"
drink_recomendation[ugedruk_mand < 22  & ugedruk_mand > 18 | ugedruk_kvinde < 15 & ugedruk_kvinde > 11]               <- "Drank close to max recomended last week"
drink_recomendation[ugedruk_mand < 19  & ugedruk_mand > 0 | ugedruk_kvinde < 12  & ugedruk_kvinde > 0]                <- "Drank less than recomended last week"
drink_recomendation[ugedruk_mand == 0 | ugedruk_kvinde == 0]                                                          <- "Did not drink last week"
drink_recomendation[ugedruk_mand == 8888 & ugedruk_kvinde == 8888 | is.na(drink_recomendation_woman)]                 <- NA
data$drink_recomendation                                                                                              <- drink_recomendation
drinking_10plus_units_last_month <- as.character(måneddruk_10genstande)
d <- as.numeric(drinking_10plus_units_last_month)
drinking_10plus_units_last_month[d  > 1]             <- "Has been drinking more than 10 units at least 2 times the past month"
drinking_10plus_units_last_month[d  == 1]            <- "Has been drinking more than 10 units 1 time the past month"
drinking_10plus_units_last_month[d  == 0]            <- "Has not been drinking more than 10 units the past month"
data$drinking_10plus_units_last_month                <- drinking_10plus_units_last_month
detach(data)
save(data, file="data")
#######
# MCA
setwd("~/My Dropbox/R/soc.ca")
source("soc.ca.r", encoding="UTF-8")
setwd("//ibtsrv2b/usr/stork/Data/R")
load("data")
attach(data)
social.rum.aktive <- data.frame(løn_mca, køn_partner, uddannelse_mca2, far_mca, arbejde_mca, grundbolig, postnumre_inddelt, opvækst_bystørrelse_mca)
set.passive(c("Missing","MISSING", "EMPTY"))
social.rum       <- invert(soc.ca(social.rum.aktive), dim=1:2)
social.rum
detach(data)
# Svensker filter
data[data$region != "Dansk",] <- NA
attach(data)
#######################################################################################
##################################### Normer og moral #################################
### Selvbillede v.3
# selvbillede       <- data.frame(livsnyder_selvbillede, kropspleje_selvbillede, karriereminded_selvbillede, familieminded_selvbillede,
#                           festlig_selvbillede, sportsudøver_selvbillede, selskabelig_selvbillede,
#                           kulturel_selvbillede, kontrolleret_selvbillede, spænding_selvbillede)
selvbillede       <- data.frame(kropspleje_selvbillede,
selskabelig_selvbillede, ufestlig)
ca.selvbillede    <- invert(soc.ca(social.rum.aktive, sup=selvbillede), dim=1:2)
#p.sup(ca.selvbillede, dim=c(2,1))
### Fornuft v.3
# fornuft           <- data.frame(par30_fornuft, par45_fornuft, midaldpar_fornuft, mand30_fornuft, kvinde_fornuft)
# fornuft           <- data.frame(par30_binær, par45_binær, vinhykler, hverdagsfornuft, bingefornuft, ikkefornuftigt)
fornuft           <- data.frame(par30_binær, par45_binær, hverdagsfornuft, bingefornuft, ikkefornuftigt)
ca.fornuft        <- invert(soc.ca(social.rum.aktive, sup=fornuft), dim=1:2)
#p.sup(ca.fornuft, dim=c(2,1))
### Accept v.3
# accept            <- data.frame(okfuld, børn_okalkohol, bil_okalkohol, cykel_okalkohol, arbejd_okalkohol, hverdag_okalkohol,
#                                 søndag_okalkohol, fest_okalkohol, julefrokost_okalkohol, festbørn_okalkohol)
# accept            <- data.frame(okfuld, okarbejde, okbørn, okcykel, okfestbørn, okjulefrokost)
accept            <- data.frame(okfuld, okarbejde, okbørn, okcykel, okjulefrokost, okdeterikkeok, okhverdag, okfest)
ca.accept         <- invert(soc.ca(social.rum.aktive, sup=accept), dim=1:2)
#p.sup(ca.accept, dim=c(2,1))
############################################################################
########################## Risiko ##########################################
### Stoffer v.3
stoffer            <- data.frame(drugs, hash, kokain, amfetamin)
ca.stoffer         <- invert(soc.ca(social.rum.aktive, sup=stoffer), dim=1:2)
#p.sup(ca.stoffer, dim=c(2,1))
### Spritkørsel v.3
#spritkørsel        <- data.frame(convictdrunkdriving, drunkdrivingmax, antalspritkørsler)
spritkørsel        <- data.frame(convictdrunkdriving, maxspritkørsel, antalspritkørsler)
ca.spritkørsel     <- invert(soc.ca(social.rum.aktive, sup=spritkørsel), dim=1:2)
#p.sup(ca.spritkørsel, dim=c(2,1))
### Fortryde v.3
# fortryde           <- data.frame(quarrel,embarass_self, overspending, regret_health, regretdullness,
#                                  regretfriend, regretslander, regretflirt)
fortryde           <- data.frame(quarrel,embarass_self, overspending, regret_health, regretdullness,
regretfriend, regretflirt, ingenkonflikt_konflikt)
ca.fortryde        <- invert(soc.ca(social.rum.aktive, sup=fortryde), dim=1:2)
### Positive konsekvenser af alkohol v.3
# poskons            <- data.frame(madoplevelse_poskons, selvtillid_poskons, slappeaf_poskons, venskaber_poskons,
#                                  karriere_poskons, sjoveoplevelser_poskons, fysisksmerte_poskons, psykiskenede_poskons)
poskons            <- data.frame(fysisksmerte_poskons, selvbehandling, psykiskenede_poskons, vurderinghelbred)
ca.poskons         <- invert(soc.ca(social.rum.aktive, sup=poskons), dim=1:2)
### Begrænse v.3
# begræns           <- data.frame(reduce, worry, gravid_skærenedhvorfor, fikbørn_skærenedhvorfor, ikkealkosygdom_skærenedhvorfor,
#                                 alkosygdom_skærenedhvorfor, opfordring_skærenedhvorfor, ikkestyrealkohol_skærenedhvorfor,
#                                 sundhed_skærenedhvorfor, vægttab_skærenedhvorfor, stedilivet_skærenedhvorfor, behandlingalkohol)
begræns           <- data.frame(reduce, worry, stedilivet_skærenedhvorfor, skærenedbørn, skærenedsundhedogvægt)
ca.begræns        <- invert(soc.ca(social.rum.aktive, sup=begræns), dim=1:2)
### Audit v.3
# audit             <- data.frame(worry,auditduhavdesvrtvedatstoppedaduf, auditdumttehaveenlillenommorgene,
#                                 auditdukunneikkehuskehvaddersket, auditdufikdrligsamvittighedeller)
audit             <- data.frame(auditstoppe, auditmorgendram, audithuske, auditsamvittighed, auditskala)
ca.audit          <- invert(soc.ca(social.rum.aktive, sup=audit), dim=1:2)
### Rygning, fedme og sundhed v.3
rygning           <- data.frame(ryger)
ca.rygning        <- invert(soc.ca(social.rum.aktive, sup=rygning), dim=1:2)
######################################################################################
########################## Drikke praksis ############################################
### Bingeadfærd v.3
#binge             <- data.frame(gåkold, genstande_es, weekenddruk, gåhjem, tællegenstande, tømmermænd, bingefrekvens_cat)
binge             <- data.frame(pass_out, on_top_off_the_world, max_drinking, tømmermænd, bingefrekvens_cat,
every_binge_1_5, every_binge_1_2, gåhjem)
ca.binge          <- invert(soc.ca(social.rum.aktive, sup=binge), dim=1:2)
### Hverdagsalkohol v.3
hverdag           <- data.frame(drukalene, partnerdruk, everyday, maxhverdag_kat, weekenddruk_kat, hverdagsdruk_gnm_kat, drink_recomendation_man, drink_recomendation_woman, drink_recomendation)
ca.hverdag        <- invert(soc.ca(social.rum.aktive, sup=hverdag), dim=1:2)
#### Drukvar
### Mangler omkodning af drinking_3plus_units_last_month
drukvar           <- data.frame(drinking_last_month, drinking_3plus_units_last_month, drinking_6plus_units_last_month,
drinking_10plus_units_last_month)
ca.drukvar        <- invert(soc.ca(social.rum.aktive, sup=drukvar), dim=1:2)
###################################################################################################################################
alle              <- data.frame(selvbillede, fornuft, accept, stoffer, spritkørsel, fortryde, poskons,
begræns, audit, rygning, binge, hverdag, drukvar)
ca.alle           <- invert(soc.ca(social.rum.aktive, sup=alle), dim=1:2)
drukplot          <- data.frame(maxhverdag, passout, ontop, drink3plus, drink6plus, bingeandel, hverdagsdruk_gnm, weekenddruk)
ca.drukplot       <- invert(soc.ca(social.rum.aktive, sup=drukplot), dim=1:2)
suple             <- data.frame(selskabelig_selvbillede, par30_binær, par45_binær, okfuld, okarbejde, okbørn, okcykel, okjulefrokost, kropspleje_selvbillede, okdeterikkeok,
hash, convictdrunkdriving, maxspritkørsel, antalspritkørsler, quarrel, embarass_self, overspending, regret_health, regretfriend, regretflirt, reduce, vurderinghelbred, worry, skærenedbørn, skærenedsundhedogvægt, auditstoppe, auditmorgendram, audithuske, auditsamvittighed, ryger,
pass_out, on_top_off_the_world, tømmermænd, partnerdruk, drinking_last_month, drinking_6plus_units_last_month, drink_recomendation, drinking_10plus_units_last_month, hverdagsdruk_gnm_kat, maxhverdag_kat, okfest, okhverdag)
ca.suple         <- invert(soc.ca(social.rum.aktive, sup=suple), dim=1:2)
baggrund         <- data.frame(alder)
ca.baggrund      <- invert(soc.ca(social.rum.aktive, sup=baggrund), dim=1:2)
###################################################################################################################################
taget             <- data.frame(selvbillede, fornuft, accept, stoffer, spritkørsel, fortryde, poskons, begræns, audit, rygning)
a                 <- colnames(data) %in% colnames(taget)
noquote(as.matrix(colnames(data)[a==FALSE]))
#######################################
#######################################
require(gplots)
?cut
X <- maxhverdag
n<-plot(ecdf(X))
nif <- function(x) cut(x,unique(floor(quantile(x,na.rm=TRUE,probs=seq(0, 1, 0.01)))),include.lowest=TRUE)
drukplot2 <- data.frame(maxhverdag, passout, ontop, drink3plus, drink6plus, hverdagsdruk_gnm, weekenddruk)
drukplot2 <- as.data.frame(apply(drukplot2, 2, nif))
ca.drukplot2       <- invert(soc.ca(social.rum.aktive, sup=drukplot2))
########################### Udgået
### Årsag v.2
# Udgår
# årsag            <- data.frame(smagsoplevelse_årsagtildruk, godrus_årsagtildruk, afslapning_årsagtildruk, dulmubehag_årsagtildruk,
#                                selvsikker_årsagtildruk, andredrikker_årsagtildruk, letsnak_årsagtildruk, vilikkesvare_årsagtildruk)
# ca.årsag         <- invert(soc.ca(social.rum.aktive, sup=årsag))
#p.sup(ca.årsag, dim=c(2,1))
### Fravær v.2 Udgår
# fravær             <- data.frame(hjemmearbdag_fravær, sygemelding_fravær, passebørn_fravær, rengøring_fravær,
#                                  afbudvenner_fravær,afbudsport_fravær, fravær_kat)
# ca.fravær          <- invert(soc.ca(social.rum.aktive, sup=fravær))
### Samvittighed v.2 Udgår
# samvittighed       <- data.frame(skænderi_samvittigh, behandletven_samvittigh, sløvhed_samvittigh, helbred_samvittigh,
#                                  pengebrug_samvittigh, hemmelighed_samvittigh, bagtalt_samvittigh, pengetab_samvittigh,
#                                  utroskab_samvittigh, flirt_samvittigh, kriminalitet_samvittigh, slagsmål_samvittigh)
# ca.samvittighed    <- invert(soc.ca(social.rum.aktive, sup=samvittighed))
### Andre v.3 UDGÅR
# andre            <- data.frame(omgangskreds, danskere, danskerehykler)
# ca.andre         <- invert(soc.ca(social.rum.aktive, sup=andre))
#p.sup(ca.andre, dim=c(2,1))
### Konflikt v.3 UDGÅR
# konflikt           <- data.frame(ingenkonflikt_konflikt, flovselv_konflikt, flovandre_konflikt, skænderi_konflikt,
#                                  parforhold_konflikt, venskab_konflikt, slagsmål_konflikt, andet_konflikt)
# konflikt           <- data.frame(ingenkonflikt_konflikt)
# ca.konflikt        <- invert(soc.ca(social.rum.aktive, sup=konflikt))
# set.passive(c("NaN", "EMPTY"))
# alkopraksis  <- data.frame(drukvar, hverdag, binge, accept)
# ca.alkopraksis <- soc.ca(alkopraksis)
# ca.alkopraksis
#
# tab.dim(ca.alkopraksis, 2)
#
# active       <- data.frame(livsnyder_selvbillede, kropspleje_selvbillede, karriereminded_selvbillede, familieminded_selvbillede,
#                            festlig_selvbillede, sportsudøver_selvbillede, selskabelig_selvbillede,
#                            kulturel_selvbillede, kontrolleret_selvbillede, spænding_selvbillede)
#
# active       <- data.frame(livsnyder_selvbillede, kropspleje_selvbillede, karriereminded_selvbillede, familieminded_selvbillede,
#                            festlig_selvbillede, sportsudøver_selvbillede, selskabelig_selvbillede,
#                            kulturel_selvbillede, kontrolleret_selvbillede, spænding_selvbillede, spirits, cider, far_mca, druksmag_kat, reduce)
#
# res <- soc.ca(active)
# res
#
# sample.test(res, active)
# as.matrix(colnames(data))
#
# sample.test(res, active)
# sample.test(social.rum, social.rum.aktive, sample.sizes=seq(0.01, 0.99, by=0.001))
# sample.test(res, active, sample.sizes=seq(0.01, 0.99, by=0.001))
#
# sample.test(social.rum, social.rum.aktive, sample.sizes=seq(1.5, 0.5, by=-0.01))
#
#
# sample.test(res, active, sample.sizes=c(rep(0.01, 30), rep(0.5, 10))
setwd("//ibtsrv2b/usr/stork/Data/R")
source("2_MCA.R", encoding="UTF-8")
library(gplots)
# Function
report <- function(ca.list){
setwd("//ibtsrv2b/usr/stork/Data/R")
source("2_MCA.R", encoding="UTF-8")
library(gplots)
)
setwd("//ibtsrv2b/usr/stork/Data/R")
source("2_MCA.R", encoding="UTF-8")
install.packages(c("boot", "class", "cluster", "colorspace", "dichromat", "digest", "foreign", "KernSmooth", "lattice", "MASS", "Matrix", "mgcv", "munsell", "nlme", "nnet", "plyr", "proto", "psych", "scales", "spatial", "stringr", "survival"))
